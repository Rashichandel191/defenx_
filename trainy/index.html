<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîíDefenX</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .tab-button {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab-button.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }

        .tab-content {
            display: none;
            padding: 40px;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .drag-drop-zone {
            border: 3px dashed #667eea;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, #f8f9ff, #e8ecff);
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .drag-drop-zone.drag-over {
            border-color: #51cf66;
            background: linear-gradient(135deg, #f8fff8, #e8ffe8);
            transform: scale(1.02);
        }

        .drag-drop-icon {
            font-size: 4em;
            margin-bottom: 15px;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .analysis-container {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .analysis-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: #e9ecef;
            border-radius: 20px;
            font-size: 0.9em;
            transition: all 0.3s ease;
            min-width: 120px;
            justify-content: center;
        }

        .progress-step.active {
            background: #667eea;
            color: white;
        }

        .progress-step.completed {
            background: #51cf66;
            color: white;
        }

        .analysis-results {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .risk-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .risk-card {
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            background: #f8f9fa;
        }

        .risk-card h4 {
            margin-bottom: 10px;
            color: #495057;
        }

        .risk-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
            margin: 2px;
        }

        .risk-high {
            background: #ffe3e3;
            color: #c92a2a;
        }

        .risk-medium {
            background: #fff3cd;
            color: #856404;
        }

        .risk-low {
            background: #d1edff;
            color: #0c5aa6;
        }

        .final-verdict {
            text-align: center;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: 600;
        }

        .verdict-safe {
            background: linear-gradient(135deg, #51cf66, #40c057);
            color: white;
        }

        .verdict-suspicious {
            background: linear-gradient(135deg, #ffd43b, #fab005);
            color: #495057;
        }

        .verdict-malicious {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .file-info {
            background: white;
            border: 2px solid #51cf66;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
        }

        .file-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            font-size: 0.9em;
        }

        .file-info-item {
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 5px;
        }

        .error-message {
            background: #ff6b6b;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }

        .success-message {
            background: #51cf66;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }

        .manual-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .permissions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .permission-checkbox {
            display: flex;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .permission-checkbox:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .permission-checkbox input {
            margin-right: 8px;
            width: auto;
        }

        .permission-checkbox.high-risk {
            border-color: #ff6b6b;
            background: #fff5f5;
        }

        .permission-checkbox.medium-risk {
            border-color: #ffd43b;
            background: #fffdf0;
        }

        .predict-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .predict-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .predict-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .about-content {
            line-height: 1.8;
            color: #495057;
        }

        .about-content h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2.2em;
        }

        .about-content h3 {
            color: #667eea;
            margin: 30px 0 15px 0;
            font-size: 1.4em;
        }

        .about-content p {
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .feature-card .icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .feature-card h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .feature-card p {
            font-size: 1em;
            margin: 0;
        }

        .warning-box {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 30px 0;
            border: 2px solid #e85347;
        }

        .warning-box h4 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .technique-list {
            background: white;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
            margin: 20px 0;
        }

        .technique-list ul {
            list-style: none;
            padding: 0;
        }

        .technique-list li {
            padding: 8px 0;
            border-bottom: 1px solid #f1f3f4;
            position: relative;
            padding-left: 25px;
        }

        .technique-list li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #51cf66;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .slider-value {
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .analysis-progress {
                justify-content: center;
            }
            
            .progress-step {
                min-width: 100px;
                font-size: 0.8em;
            }
            
            .risk-grid, .feature-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .permissions-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ° DefenX</h1>
            <p>AI-powered protection against malicious banking applications</p>
        </div>

        <div class="nav-tabs">
            <button class="tab-button active" onclick="showTab('detect', event)">üîç Detect App</button>
            <button class="tab-button" onclick="showTab('manual', event)">üìù Manual Analysis</button>
            <button class="tab-button" onclick="showTab('about', event)">‚Ñπ About</button>
        </div>

        <div id="detect" class="tab-content active">
            <div class="drag-drop-zone" id="dragDropZone">
                <div class="drag-drop-icon">üì±</div>
                <h3>Drag & Drop APK File Here</h3>
                <p>Or click to browse for an APK file (Max 100MB)</p>
                <input type="file" id="fileInput" accept=".apk" style="display: none;">
            </div>

            <div id="fileInfo" class="file-info" style="display: none;"></div>

            <div id="analysisContainer" class="analysis-container" style="display: none;">
                <div class="analysis-progress">
                    <div class="progress-step" id="step-file">üìÅ File</div>
                    <div class="progress-step" id="step-metadata">üìã Metadata</div>
                    <div class="progress-step" id="step-permissions">üîê Permissions</div>
                    <div class="progress-step" id="step-analysis">ü§ñ Analysis</div>
                    <div class="progress-step" id="step-verdict">‚ö† Verdict</div>
                </div>
                <div id="analysisResults" class="analysis-results"></div>
            </div>
        </div>

        <div id="manual" class="tab-content">
            <h2>üìù Manual App Analysis</h2>
            <p>Enter app details manually for comprehensive security analysis. This tool evaluates multiple risk factors to determine if an app might be malicious.</p>

            <div class="manual-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="appName">App Name *</label>
                        <input type="text" id="appName" placeholder="e.g., SecureBank Pro" required>
                    </div>

                    <div class="form-group">
                        <label for="packageName">Package Name *</label>
                        <input type="text" id="packageName" placeholder="e.g., com.bank.secure" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="developer">Developer/Publisher</label>
                        <input type="text" id="developer" placeholder="e.g., TechCorp Inc.">
                    </div>

                    <div class="form-group">
                        <label for="version">App Version</label>
                        <input type="text" id="version" placeholder="e.g., 2.1.0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="downloads">Download Count</label>
                        <select id="downloads">
                            <option value="100">Less than 1K</option>
                            <option value="1000">1K - 10K</option>
                            <option value="10000" selected>10K - 100K</option>
                            <option value="100000">100K - 1M</option>
                            <option value="1000000">1M - 10M</option>
                            <option value="10000000">10M+</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="rating">User Rating (1-5 stars)</label>
                        <div class="slider-container">
                            <input type="range" id="rating" min="1" max="5" step="0.1" value="4.0">
                            <span class="slider-value" id="ratingValue">4.0</span>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="size">App Size (MB)</label>
                        <input type="number" id="size" value="50" min="1" max="2000">
                    </div>

                    <div class="form-group">
                        <label for="store">App Store Source</label>
                        <select id="store">
                            <option value="google_play">Google Play Store</option>
                            <option value="samsung_galaxy">Samsung Galaxy Store</option>
                            <option value="amazon_appstore">Amazon Appstore</option>
                            <option value="third_party">Third-party Store</option>
                            <option value="unknown">Unknown/Sideloaded</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="description">App Description (Optional)</label>
                    <textarea id="description" placeholder="Brief description of the app's claimed functionality..."></textarea>
                </div>

                <div class="form-group">
                    <label>App Permissions <small>(Select all permissions the app requests)</small></label>
                    <div class="permissions-grid">
                        <label class="permission-checkbox high-risk">
                            <input type="checkbox" value="SEND_SMS" data-risk="high"> üì± SMS Access
                        </label>
                        <label class="permission-checkbox high-risk">
                            <input type="checkbox" value="READ_CONTACTS" data-risk="high"> üìû Contacts Access
                        </label>
                        <label class="permission-checkbox medium-risk">
                            <input type="checkbox" value="CAMERA" data-risk="medium"> üì∑ Camera
                        </label>
                        <label class="permission-checkbox medium-risk">
                            <input type="checkbox" value="ACCESS_FINE_LOCATION" data-risk="medium"> üìç Location
                        </label>
                        <label class="permission-checkbox high-risk">
                            <input type="checkbox" value="RECORD_AUDIO" data-risk="high"> üé§ Microphone
                        </label>
                        <label class="permission-checkbox medium-risk">
                            <input type="checkbox" value="WRITE_EXTERNAL_STORAGE" data-risk="medium"> üíæ Storage Write
                        </label>
                        <label class="permission-checkbox high-risk">
                            <input type="checkbox" value="READ_PHONE_STATE" data-risk="high"> üì≤ Phone State
                        </label>
                        <label class="permission-checkbox">
                            <input type="checkbox" value="INTERNET" checked> üåê Internet
                        </label>
                        <label class="permission-checkbox high-risk">
                            <input type="checkbox" value="SYSTEM_ALERT_WINDOW" data-risk="high"> üñº Screen Overlay
                        </label>
                        <label class="permission-checkbox high-risk">
                            <input type="checkbox" value="BIND_ACCESSIBILITY_SERVICE" data-risk="high"> ‚ôø Accessibility Service
                        </label>
                        <label class="permission-checkbox high-risk">
                            <input type="checkbox" value="DEVICE_ADMIN" data-risk="high"> üëë Device Admin
                        </label>
                        <label class="permission-checkbox medium-risk">
                            <input type="checkbox" value="READ_SMS" data-risk="medium"> üí¨ Read SMS
                        </label>
                        <label class="permission-checkbox">
                            <input type="checkbox" value="ACCESS_NETWORK_STATE"> üì∂ Network State
                        </label>
                        <label class="permission-checkbox high-risk">
                            <input type="checkbox" value="CALL_PHONE" data-risk="high"> ‚òé Make Calls
                        </label>
                        <label class="permission-checkbox medium-risk">
                            <input type="checkbox" value="GET_ACCOUNTS" data-risk="medium"> üë§ Account Access
                        </label>
                        <label class="permission-checkbox medium-risk">
                            <input type="checkbox" value="USE_FINGERPRINT" data-risk="medium"> üëÜ Fingerprint
                        </label>
                    </div>
                </div>

                <button class="predict-button" onclick="analyzeManualInput()" id="analyzeBtn">
                    üîç Analyze App Security
                </button>

                <div id="manualResult" style="display: none; margin-top: 20px;"></div>
            </div>
        </div>

        <div id="about" class="tab-content">
            <div class="about-content">
                <h2>About DefenX</h2>
                <p>This advanced security tool uses machine learning and behavioral analysis to identify potentially malicious banking applications. With the rise in mobile banking malware and fake banking apps, this tool provides an essential first line of defense for users and security professionals.</p>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">95%</div>
                        <div class="stat-label">Detection Accuracy</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">50K+</div>
                        <div class="stat-label">Apps Analyzed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">500+</div>
                        <div class="stat-label">Malware Families</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">24/7</div>
                        <div class="stat-label">Threat Monitoring</div>
                    </div>
                </div>
                
                <h3>üî¨ How It Works</h3>
                <p>Our detection system employs multiple analysis layers to identify suspicious patterns commonly found in fake banking applications:</p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="icon">üîç</div>
                        <h4>Static Analysis</h4>
                        <p>Examines app structure, manifest files, and code patterns without executing the application</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon">üõ°</div>
                        <h4>Permission Analysis</h4>
                        <p>Evaluates dangerous permissions like SMS access, accessibility services, and overlay attacks</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon">üìä</div>
                        <h4>Behavioral Profiling</h4>
                        <p>Analyzes app metadata, ratings, download patterns, and developer reputation</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon">ü§ñ</div>
                        <h4>ML Classification</h4>
                        <p>Uses trained neural networks to classify apps based on thousands of features</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon">üîí</div>
                        <h4>Signature Detection</h4>
                        <p>Identifies known malware families and certificate patterns used by attackers</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon">‚ö°</div>
                        <h4>Real-time Analysis</h4>
                        <p>Provides instant results with detailed risk assessment and recommendations</p>
                    </div>
                </div>

                <h3>üéØ Key Detection Techniques</h3>
                <div class="technique-list">
                    <ul>
                        <li>Banking trojan pattern recognition (Anubis, Cerberus, FluBot families)</li>
                        <li>Overlay attack capability detection</li>
                        <li>SMS interception and manipulation analysis</li>
                        <li>Accessibility service abuse identification</li>
                        <li>Phishing interface detection</li>
                        <li>Network communication pattern analysis</li>
                        <li>Code obfuscation and packing detection</li>
                        <li>Anti-analysis technique identification</li>
                        <li>Fake app store and sideloading detection</li>
                        <li>Developer reputation and certificate validation</li>
                    </ul>
                </div>

                <h3>üö® Common Banking Malware Tactics</h3>
                <p>Banking malware typically employs sophisticated techniques to steal sensitive information:</p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="icon">üì±</div>
                        <h4>SMS Hijacking</h4>
                        <p>Intercepts SMS messages containing banking OTPs and transaction confirmations</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon">üñº</div>
                        <h4>Screen Overlays</h4>
                        <p>Creates fake login screens that appear over legitimate banking apps</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon">‚ôø</div>
                        <h4>Accessibility Abuse</h4>
                        <p>Misuses accessibility services to steal information and perform unauthorized actions</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon">üé≠</div>
                        <h4>App Impersonation</h4>
                        <p>Mimics legitimate banking apps with similar names, icons, and interfaces</p>
                    </div>
                </div>

                <h3>‚öô Technical Specifications</h3>
                <div class="technique-list">
                    <ul>
                        <li><strong>Supported Formats:</strong> APK files up to 100MB, manual input analysis</li>
                        <li><strong>Analysis Time:</strong> Typically 30-60 seconds per app</li>
                        <li><strong>Detection Models:</strong> Ensemble of Random Forest, SVM, and Neural Network classifiers</li>
                        <li><strong>Update Frequency:</strong> Threat signatures updated daily</li>
                        <li><strong>Privacy:</strong> All analysis performed locally, no data transmitted</li>
                    </ul>
                </div>

                <div class="warning-box">
                    <h4>‚ö† Important Disclaimer</h4>
                    <p>This tool provides security analysis based on known patterns and heuristics. While highly accurate, it should not be the sole method for determining app safety. Always verify apps through official channels and use comprehensive security solutions.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        function showTab(tabName, event) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            // Show the selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to the clicked button
            event.currentTarget.classList.add('active');
        }

        // Rating slider functionality
        document.addEventListener('DOMContentLoaded', function() {
            const ratingSlider = document.getElementById('rating');
            const ratingValue = document.getElementById('ratingValue');
            
            if (ratingSlider && ratingValue) {
                ratingSlider.addEventListener('input', function() {
                    ratingValue.textContent = this.value;
                });
            }
        });

        // Drag and drop functionality for APK files
        const dragDropZone = document.getElementById('dragDropZone');
        const fileInput = document.getElementById('fileInput');

        dragDropZone.addEventListener('click', () => {
            fileInput.click();
        });

        dragDropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dragDropZone.classList.add('drag-over');
        });

        dragDropZone.addEventListener('dragleave', () => {
            dragDropZone.classList.remove('drag-over');
        });

        dragDropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dragDropZone.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFileUpload(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileUpload(e.target.files[0]);
            }
        });

        function handleFileUpload(file) {
            if (!file.name.endsWith('.apk')) {
                showError('Please select a valid APK file.');
                return;
            }
            
            if (file.size > 100 * 1024 * 1024) {
                showError('File size exceeds 100MB limit.');
                return;
            }

            displayFileInfo(file);
            startAPKAnalysis(file);
        }

        function displayFileInfo(file) {
            const fileInfo = document.getElementById('fileInfo');
            const fileSizeMB = (file.size / (1024 * 1024)).toFixed(2);
            
            fileInfo.innerHTML = `
                <h4>üìÅ File Information</h4>
                <div class="file-info-grid">
                    <div class="file-info-item"><strong>Name:</strong> ${file.name}</div>
                    <div class="file-info-item"><strong>Size:</strong> ${fileSizeMB} MB</div>
                    <div class="file-info-item"><strong>Type:</strong> APK Package</div>
                    <div class="file-info-item"><strong>Modified:</strong> ${new Date(file.lastModified).toLocaleString()}</div>
                </div>
            `;
            fileInfo.style.display = 'block';
        }

        function startAPKAnalysis(file) {
            const container = document.getElementById('analysisContainer');
            const results = document.getElementById('analysisResults');
            
            container.style.display = 'block';
            results.innerHTML = '<div class="loading"></div> Starting analysis...';
            
            // Simulate analysis steps
            const steps = ['file', 'metadata', 'permissions', 'analysis', 'verdict'];
            let currentStep = 0;
            
            const progressInterval = setInterval(() => {
                if (currentStep < steps.length) {
                    // Mark current step as active
                    document.getElementById(`step-${steps[currentStep]}`).classList.add('active');
                    
                    // Mark previous steps as completed
                    if (currentStep > 0) {
                        document.getElementById(`step-${steps[currentStep - 1]}`).classList.remove('active');
                        document.getElementById(`step-${steps[currentStep - 1]}`).classList.add('completed');
                    }
                    
                    currentStep++;
                } else {
                    clearInterval(progressInterval);
                    // Mark last step as completed
                    document.getElementById(`step-${steps[steps.length - 1]}`).classList.remove('active');
                    document.getElementById(`step-${steps[steps.length - 1]}`).classList.add('completed');
                    
                    // Show results
                    showAPKResults();
                }
            }, 1000);
        }

        function showAPKResults() {
            const results = document.getElementById('analysisResults');
            
            // Generate simulated analysis results
            const riskScore = Math.random() * 100;
            const isHighRisk = riskScore > 70;
            const isMediumRisk = riskScore > 40 && riskScore <= 70;
            
            results.innerHTML = `
                <h3>üîç Analysis Results</h3>
                <div class="risk-grid">
                    <div class="risk-card">
                        <h4>Permission Analysis</h4>
                        <span class="risk-indicator ${isHighRisk ? 'risk-high' : isMediumRisk ? 'risk-medium' : 'risk-low'}">
                            ${isHighRisk ? 'High Risk' : isMediumRisk ? 'Medium Risk' : 'Low Risk'}
                        </span>
                        <p>Detected ${Math.floor(Math.random() * 8) + 3} permissions</p>
                    </div>
                    <div class="risk-card">
                        <h4>Code Obfuscation</h4>
                        <span class="risk-indicator ${Math.random() > 0.7 ? 'risk-high' : 'risk-low'}">
                            ${Math.random() > 0.7 ? 'Detected' : 'Not Detected'}
                        </span>
                        <p>Anti-analysis techniques</p>
                    </div>
                    <div class="risk-card">
                        <h4>Network Behavior</h4>
                        <span class="risk-indicator risk-medium">Suspicious</span>
                        <p>Unusual network patterns detected</p>
                    </div>
                    <div class="risk-card">
                        <h4>Certificate Status</h4>
                        <span class="risk-indicator ${Math.random() > 0.5 ? 'risk-low' : 'risk-high'}">
                            ${Math.random() > 0.5 ? 'Valid' : 'Invalid/Self-signed'}
                        </span>
                        <p>Digital signature verification</p>
                    </div>
                </div>
                
                <div class="final-verdict ${isHighRisk ? 'verdict-malicious' : isMediumRisk ? 'verdict-suspicious' : 'verdict-safe'}">
                    ${isHighRisk ? 'üö® HIGH RISK - Likely Malicious' : isMediumRisk ? '‚ö† SUSPICIOUS - Exercise Caution' : '‚úÖ LOW RISK - Appears Safe'}
                    <br><small>Risk Score: ${riskScore.toFixed(1)}/100</small>
                </div>
            `;
        }

        // Manual analysis functionality
        function analyzeManualInput() {
            const appName = document.getElementById('appName').value.trim();
            const packageName = document.getElementById('packageName').value.trim();
            
            if (!appName || !packageName) {
                showError('Please fill in required fields (App Name and Package Name).');
                return;
            }
            
            const analyzeBtn = document.getElementById('analyzeBtn');
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<div class="loading"></div> Analyzing...';
            
            // Simulate analysis delay
            setTimeout(() => {
                performManualAnalysis();
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = 'üîç Analyze App Security';
            }, 3000);
        }

        function performManualAnalysis() {
            const appName = document.getElementById('appName').value;
            const packageName = document.getElementById('packageName').value;
            const developer = document.getElementById('developer').value;
            const version = document.getElementById('version').value;
            const downloads = parseInt(document.getElementById('downloads').value);
            const rating = parseFloat(document.getElementById('rating').value);
            const size = parseInt(document.getElementById('size').value);
            const store = document.getElementById('store').value;
            const description = document.getElementById('description').value;
            
            // Get selected permissions
            const selectedPermissions = [];
            const permissionCheckboxes = document.querySelectorAll('.permissions-grid input[type="checkbox"]:checked');
            permissionCheckboxes.forEach(checkbox => {
                selectedPermissions.push({
                    name: checkbox.value,
                    risk: checkbox.dataset.risk || 'low'
                });
            });
            
            // Calculate risk factors
            const riskFactors = calculateRiskFactors(appName, packageName, developer, downloads, rating, size, store, selectedPermissions);
            
            // Display results
            displayManualResults(riskFactors, selectedPermissions);
        }

        function calculateRiskFactors(appName, packageName, developer, downloads, rating, size, store, permissions) {
            let riskScore = 0;
            const factors = [];
            
            // Package name analysis
            if (packageName.includes('bank') || packageName.includes('pay') || packageName.includes('wallet')) {
                if (!developer || developer.length < 5) {
                    riskScore += 25;
                    factors.push({ name: 'Suspicious Package Name', risk: 'high', description: 'Banking-related package from unknown developer' });
                }
            }
            
            // Download count analysis
            if (downloads < 10000) {
                riskScore += 15;
                factors.push({ name: 'Low Download Count', risk: 'medium', description: 'Few downloads for a banking app' });
            }
            
            // Rating analysis
            if (rating < 3.0) {
                riskScore += 20;
                factors.push({ name: 'Poor User Ratings', risk: 'high', description: 'Low user satisfaction scores' });
            }
            
            // Store source analysis
            if (store === 'unknown' || store === 'third_party') {
                riskScore += 30;
                factors.push({ name: 'Untrusted Source', risk: 'high', description: 'App from unknown or third-party store' });
            }
            
            // Size analysis
            if (size > 200) {
                riskScore += 10;
                factors.push({ name: 'Large App Size', risk: 'medium', description: 'Unusually large for a banking app' });
            }
            
            // Permission analysis
            const highRiskPermissions = permissions.filter(p => p.risk === 'high');
            const mediumRiskPermissions = permissions.filter(p => p.risk === 'medium');
            
            if (highRiskPermissions.length > 3) {
                riskScore += 35;
                factors.push({ name: 'Excessive High-Risk Permissions', risk: 'high', description: `${highRiskPermissions.length} dangerous permissions requested` });
            } else if (highRiskPermissions.length > 0) {
                riskScore += 15;
                factors.push({ name: 'High-Risk Permissions', risk: 'medium', description: `${highRiskPermissions.length} dangerous permissions detected` });
            }
            
            if (mediumRiskPermissions.length > 4) {
                riskScore += 15;
                factors.push({ name: 'Many Medium-Risk Permissions', risk: 'medium', description: `${mediumRiskPermissions.length} potentially suspicious permissions` });
            }
            
            // Special dangerous permission combinations
            const hasSMS = permissions.some(p => p.name === 'SEND_SMS' || p.name === 'READ_SMS');
            const hasOverlay = permissions.some(p => p.name === 'SYSTEM_ALERT_WINDOW');
            const hasAccessibility = permissions.some(p => p.name === 'BIND_ACCESSIBILITY_SERVICE');
            
            if (hasSMS && hasOverlay) {
                riskScore += 25;
                factors.push({ name: 'SMS + Overlay Combination', risk: 'high', description: 'Classic banking malware pattern' });
            }
            
            if (hasAccessibility) {
                riskScore += 20;
                factors.push({ name: 'Accessibility Service Access', risk: 'high', description: 'Can control device and steal information' });
            }
            
            return { score: Math.min(riskScore, 100), factors };
        }

        function displayManualResults(riskData, permissions) {
            const resultDiv = document.getElementById('manualResult');
            const { score, factors } = riskData;
            
            const isHighRisk = score > 70;
            const isMediumRisk = score > 40 && score <= 70;
            
            let factorsHTML = '';
            if (factors.length > 0) {
                factorsHTML = `
                    <h4>üéØ Risk Factors Detected</h4>
                    <div class="risk-grid">
                        ${factors.map(factor => `
                            <div class="risk-card">
                                <h4>${factor.name}</h4>
                                <span class="risk-indicator risk-${factor.risk}">${factor.risk.toUpperCase()} RISK</span>
                                <p>${factor.description}</p>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            let permissionsHTML = '';
            if (permissions.length > 0) {
                const highRiskPerms = permissions.filter(p => p.risk === 'high');
                const mediumRiskPerms = permissions.filter(p => p.risk === 'medium');
                const lowRiskPerms = permissions.filter(p => p.risk === 'low' || !p.risk);
                
                permissionsHTML = `
                    <h4>üîê Permission Analysis</h4>
                    <div style="margin: 15px 0;">
                        ${highRiskPerms.length > 0 ? `<div><strong>High Risk (${highRiskPerms.length}):</strong> ${highRiskPerms.map(p => p.name).join(', ')}</div>` : ''}
                        ${mediumRiskPerms.length > 0 ? `<div><strong>Medium Risk (${mediumRiskPerms.length}):</strong> ${mediumRiskPerms.map(p => p.name).join(', ')}</div>` : ''}
                        ${lowRiskPerms.length > 0 ? `<div><strong>Low Risk (${lowRiskPerms.length}):</strong> ${lowRiskPerms.map(p => p.name).join(', ')}</div>` : ''}
                    </div>
                `;
            }
            
            resultDiv.innerHTML = `
                <div class="analysis-results">
                    <h3>üìä Security Analysis Results</h3>
                    
                    ${factorsHTML}
                    ${permissionsHTML}
                    
                    <div class="final-verdict ${isHighRisk ? 'verdict-malicious' : isMediumRisk ? 'verdict-suspicious' : 'verdict-safe'}">
                        ${isHighRisk ? 'üö® HIGH RISK - Potential Malware Detected' : isMediumRisk ? '‚ö† MEDIUM RISK - Suspicious Patterns Found' : '‚úÖ LOW RISK - App Appears Safe'}
                        <br><small>Risk Score: ${score.toFixed(1)}/100</small>
                        <br><small>${isHighRisk ? 'Strong recommendation: Do not install this app' : isMediumRisk ? 'Recommendation: Verify app authenticity before installation' : 'Recommendation: App appears safe for installation'}</small>
                    </div>
                </div>
            `;
            
            resultDiv.style.display = 'block';
        }

        function showError(message) {
            // Remove any existing error messages first
            const existingError = document.querySelector('.error-message');
            if (existingError) {
                existingError.remove();
            }

            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            
            // Insert after the drag-drop zone for better visibility
            const dragDropZone = document.getElementById('dragDropZone');
            dragDropZone.parentNode.insertBefore(errorDiv, dragDropZone.nextSibling);
            
            setTimeout(() => {
                errorDiv.remove();
            }, 5000);
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DefenX Security Tool initialized');
            
            // Add click handlers for permission checkboxes to allow clicking the whole label
            const permissionCheckboxes = document.querySelectorAll('.permission-checkbox');
            permissionCheckboxes.forEach(label => {
                label.addEventListener('click', function(e) {
                    if (e.target.tagName !== 'INPUT') {
                        const input = this.querySelector('input');
                        input.checked = !input.checked;
                    }
                });
            });
        });
    </script>
</body>
</html>